<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
BeyondAdmin - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.2.0
Version: 1.0.0
Purchase: http://wrapbootstrap.com
-->

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cn">
<!-- Head -->
<head>
    <title>模块管理</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <meta name="description" content="data tables" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="shortcut icon" href="${sys_cxt}/assets/img/favicon.png" type="image/x-icon"/>
    <link rel="stylesheet" href="${cxt }/front/css/button.css" />
    <link href="${sys_cxt}/assets/css/bootstrap.min.css" rel="stylesheet" />
    <link id="bootstrap-rtl-link" href="" rel="stylesheet" />
    <link href="${sys_cxt}/assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="${sys_cxt}/assets/css/weather-icons.min.css" rel="stylesheet" />
    <!--Fonts-->
    <!--<link href="http://fonts.useso.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300" rel="stylesheet" type="text/css">-->
    <!--Beyond styles-->
    <link rel="stylesheet" href="${sys_cxt}/assets/css/beyond.min.css" />
    <link href="${sys_cxt}/assets/css/demo.min.css" rel="stylesheet" />
    <link href="${sys_cxt}/assets/css/typicons.min.css" rel="stylesheet" />
    <link href="${sys_cxt}/assets/css/animate.min.css" rel="stylesheet" />
    <link id="skin-link" href="" rel="stylesheet" type="text/css" />
    <!--Page Related styles-->
    <link href="${sys_cxt}/assets/css/dataTables.bootstrap.css" rel="stylesheet" />	
    <!--Skin Script: Place this script in head to load scripts for skins and rtl support-->
    <script src="${sys_cxt}/assets/js/jquery-2.0.3.min.js"></script>
    <script src="${sys_cxt}/assets/js/skins.min.js"></script>
    <link href="${sys_cxt}/css/head.css" rel="stylesheet" type="text/css" />
	<link href="${sys_cxt}/css/custom.css" rel="stylesheet" type="text/css"/>
<style>
.header-right{
  	width:75%;
  	height:41px;
  	background-color: #667add;
  	color:#fff;
    float: left;
}
.header-right dl{
	float: left;
	color:#fff;
	padding: 0px 0px 0px 0px;
}
.header-right dl dt{
	padding: 12px 40px 0px 2px;
	font-size: 14px;
	font-family: "微软雅黑";
    color:#fff;
}
.header-right dl dt a{
   color:#fff; 
}
.header-right dl dt:hover {
   color: #2dc3e8;
}
.page-header .header-buttons a {
  height: 35px;
}
.page-header {
  height: 37px;
}
.page-header .header-title h1 {
           line-height: 17px;
         }
button{
	border: 0px;
	margin:auto auto 10px 10px;
}
.titl{
font-size: 1.4rem;
line-height: 35px;
}
#form th{
font-size: 1rem;
}
#form td{
font-size: 1.2rem;
}
/*a:link {color:white}
      a:visited {color: #00FF00}
   a:hover {color: #FF00FF}
   a:active {color: #0000FF}*/
.col-sm-2{
	min-width:260px;
	padding:0;
	margin:0;
	margin-bottom:15px;
}
.search_label{
	font-size:16px;
}
.search_input{
    display:inline-block;	
	height:35px;
	width:160px;
	padding-left:10px;
	font-size:16px;
}
a{color:black}
</style>
</head>
<!-- /Head -->
<!-- Body -->
<body>
    <!-- Page Header -->
    <div class="page-header position-relative">
        <div class="header-title">
            <span class="titl" >
                   网站管理                        
                <span>
                    <i class="fa fa-angle-right"></i>
                                           文章列表
                </span>
            </span>
        </div>
        <!--Header Buttons-->
        <div class="header-buttons">
            <!-- <a class="sidebar-toggler" href="#">
                <i class="fa fa-arrows-h"></i>
            </a>
            <a class="refresh" id="refresh-toggler" href="">
                <i class="glyphicon glyphicon-refresh"></i>
            </a>
            <a class="fullscreen" id="fullscreen-toggler" href="#">
                <i class="glyphicon glyphicon-fullscreen"></i>
            </a> -->
        </div>
        <!--Header Buttons End-->
    </div>
    <!-- /Page Header -->
    <!-- Page Body -->
    <div class="page-body">
        <div class="row">
            <div class="col-xs-12 col-md-12">
                <div class="widget">
                    <div class="widget-header ">
                      <!--  <span class="widget-caption">Simple DataTable</span>-->
                        <!-- <div class="widget-buttons">
                            <a href="#" data-toggle="maximize">
                                <i class="fa fa-expand"></i>
                            </a>
                            <a href="#" data-toggle="collapse">
                                <i class="fa fa-minus"></i>
                            </a>
                            <a href="#" data-toggle="dispose">
                                <i class="fa fa-times"></i>
                            </a>
                        </div> -->
                    </div>
                    <div class="widget-body" style="overflow-x:hidden;">
             			<div id="horizontal-form">
                            <form class="form-horizontal" role="form" id="fhgzwform" name="fhgzwform" method="post">
                                 <div class="form-group" style="padding-left:15px;">
                                    <div class="col-sm-2" style="font-size: 1.2rem" >
	                                    <label class="search_label" style="font-size: 1.2rem">一级栏目</label>
                                        <select style="font-size: 1.2rem" id="first_class" class="search_input" onchange="searchSecond()" name="first_class">
                                        	<option value="">请选择一级栏目</option>
                                        	<%for(column in columns){%>
                                        	<option value="${column.id}">${column.name}</option>
                                        	<%}%>
                                        </select>
                                    </div>
                                    <div class="col-sm-2">
	                                    <label class="search_label" style="font-size: 1.2rem">二级栏目</label>
                                        <select style="font-size: 1.2rem" id="second_class" class="search_input" name="second_class">
                                        	<option value="">请选择二级栏目</option>
                                        </select>
                                    </div>
                                    <div class="col-sm-2">
                                    	<label class="search_label" style="font-size: 1.2rem">文章标题</label>
                                        <input style="font-size: 1.2rem" id="title" type="text" class="search_input" name="title" value="" />
                                    </div>
                                    <div class="col-sm-2">
                                          <button type="button" class="button button-raised button-primary button-box button-small" onclick="reloadTable();"><i class="fa fa-search"></i>查询</button>
                                    </div>
                                 </div>
                                 <div class="form-group" style="padding-left:15px;">
                                    <div class="col-sm-2">
	                                    <a type="button"  class="button button-raised button-primary button-box button-small" href="${sys_cxt }/website/article/article">
											<i class="fa fa-plus"></i>新增	
								   		</a> 
								   		<button type="reset" class="button button-raised button-caution button-box button-small"  onclick="delBatch()"><i class="fa  fa-undo"></i>刪除</button>
                                    </div>
                                    <!-- <label class="col-sm-1 control-label no-padding-right"> </label>
                                    <div class="col-sm-2">
                                    	<button type="submit" class="btn btn-primary" onclick="selsub('1','${path!}','fhgzwform');"><i class="fa fa-plus"></i>导出</button>
                                    </div> -->
                                </div>
                            </form>
                        </div>
                        <form id="form">
	                      <table class="table table-striped table-bordered table-hover" id="commontable">
	                          <thead>
	                              <tr>
	                                <th style="width:5%;"><input type="checkbox" id="chk_all" name="all" onclick="check_all()" /></th>
									<th style="width:25%;font-weight: bold;" align="center">文章标题</th>
									<th style="width:10%;font-weight: bold;" align="center">作者</th>
									<th style="width:15%;font-weight: bold;" align="center">更新时间</th>
									<th style="width:20%;font-weight: bold;" align="cent  er">操作</th>
	                              </tr>
	                          </thead>
	                      </table>
	                    </form>
                  	</div>
              </div>
          </div>
      </div>
  </div>
  <!-- /Page Body -->

    <!--Basic Scripts-->
    <script src="${sys_cxt}/assets/js/bootstrap.min.js"></script>

    <!--Beyond Scripts-->
    <script src="${sys_cxt}/assets/js/beyond.min.js"></script>

    <!--Page Related Scripts-->
    <script src="${sys_cxt}/assets/js/datatable/jquery.dataTables.min.js"></script>
    <script src="${sys_cxt}/assets/js/datatable/ZeroClipboard.js"></script>
    <script src="${sys_cxt}/assets/js/datatable/dataTables.tableTools.min.js"></script>
    <script src="${sys_cxt}/assets/js/datatable/dataTables.bootstrap.min.js"></script>
    <script src="${sys_cxt}/website/article/js/table.js"></script>
    <script src="${sys_cxt}/assets/js/datatable/datatables-init.js"></script>
    <script>
        InitiateSimpleDataTable.init();
        InitiateEditableDataTable.init();
        InitiateExpandableDataTable.init();
        InitiateSearchableDataTable.init();
        InitiateCommonDataTable.init(10);
        //重新获取数据
    	function reloadTable(){
    		$("#commontable").DataTable().ajax.reload();
    	}
        //选择一级栏目后自动查询二级栏目，并填充
        function searchSecond(){
        	var columnId = $("#first_class").val();
        	$.ajax({
    			cache : true,
    			type : "POST",
    			url : "getSecondColumn",
    			data : {columnId:columnId},
    			dataType:'json',
    			async: false,
    			error : function(request) {
    				alert("连结错误！");
    			},
    			success : function(data) {
    				if(data.error == 1){
    					alert(data.msg);
    				}else{
    					var second = $("#second_class");
    					second.empty();
    					$.each(data.list,function(i){
    						var $opt = $("<option>").text(data.list[i].name).val(data.list[i].id);
	    					second.append($opt);
    					});
    				}
    			}
    		});
        }
        //生成文章静态页
        function article_generate(key){
        	$.ajax({
    			cache : true,
    			type : "POST",
    			url : "${sys_cxt}/website/generate/generateOneNewsHtml",
    			data : {articleKey:key},
    			dataType:'json',
    			async: false,
    			error : function(request) {
    				alert("连结错误！");
    			},
    			success : function(data) {
    				if(data.msg=="成功"){
    					$("#"+key+"").attr("href",data.url);
    					$("#"+key+"").attr("target","_blank");
    					$("#"+key+"").css("color","#2A6496");
    					
    				};
    				
    			}
    		});
        }
        //编辑文章
    	function article_edit(key){
    		window.location.href = "editArticle?key="+key;
    	}
    	//删除文章
    	function article_del(id){
    		$.ajax({
    			cache : true,
    			type : "POST",
    			url : "delArticle",
    			data : {id:id},
    			dataType:'json',
    			async: false,
    			error : function(request) {
    				alert("连结错误！");
    			},
    			success : function(data) {
    				alert(data.msg);
    				//window.location.reload();
    				$("#commontable").DataTable().ajax.reload();
    			}
    		});
    	}
    	//批量删除文章
    	function delBatch(){
    		$.ajax({
    			cache : true,
    			type : "POST",
    			url : "delBatch",
    			data : $('#form').serialize(),
    			dataType:'json',
    			async: false,
    			error : function(request) {
    				alert("连结错误！");
    			},
    			success : function(data) {
    				alert(data.msg);
    				//window.location.reload();
    				$("#commontable").DataTable().ajax.reload();
    			}
    		});
    	}
    	
    </script>
</body>
</html>
